---
title: 금융공학과 특성함수(Characteristic Function in Mathematical Finance)
date: 2025-11-20 21:43:05 +09:00
categories:
  - Quant & Markets
  - Derivatives & Volatility
tags:
  - 특성함수
  - 적률생성함수
  - 푸리에 변환
  - 확률분포
  - 금융공학
  - characteristic function
  - moment generating function
  - fourier transform
  - mathematical finance
  - probability distribution
math: true
---

**본 포스팅은 Cornelis W Oosterlee, Lech A Grzelak. Mathematical Modeling and Computation in Finance, 2019를 참고하여 작성하였습니다.

# 1. 확률변수의 기댓값

어떤 확률변수 $X$와 그 CDF($F_X(x)$)와 PDF($f_X(x)$)가 있을 때, 확률변수 $X$의 기댓값은 다음과 같이 정의됩니다.

$$
E(X) = \int_{-\infty}^{+\infty} x f(x) dx = \int_{-\infty}^{+\infty} x \frac{dF_X(x)}{dx} dx = \int_{-\infty}^{+\infty}x dF_X(x)
$$

이때 어떤 함수 $g(X)$가 존재한다면(ex. option payoff function), 그 기댓값은 다시 다음과 같이 나타낼 수 있습니다. (이는 무의식적인 통계학자의 정리(Law of the unconscious statistician)에 의해 성립합니다.)

$$
E[g(X)] = \int_{-\infty}^{\infty} g(x) f(x) dx
$$

# 2. 확률밀도함수를 모르는 확률변수

우리는 금융공학을 공부하면서 주식, 이자율과 같은 확률변수를 주로 다루게 됩니다. 이러한 확률변수들은 그 분포를 가지나, 그 밀도함수 (Density Function)을 알 수 없는 경우가 적지 않습니다.

가장 최선의 상황은 이러한 확률변수들의 밀도함수를 Closed form으로 알 수 있어서 기댓값, 분산 등의 계산에 활용하는 것이겠으나, 이러한 접근이 불가능한 경우에는 대안적인 방식을 고민해야 합니다.

그 중 하나는, 밀도함수를 모르더라도 기댓값이나 다른 통계량에 대한 중요한 정보를 담고 있는 다른 형태의 함수를 유도하는 것입니다. 특성함수(Characteristic Function; ChF)와 적률생성함수(Moment-generating function; mgf)가 그것입니다.

# 3. Characteristic Function(특성함수)

어떤 실수 $u \in \R$와 확률변수 $X$에 대해 주어지는 특성함수(ChF) $\phi_X(u)$는 CDF $F_X(x)$의 푸리에-스틸체스 변환(Fourier-Stieltjes Transform; FST)입니다.

$$
\phi_X(u) = E[e^{iuX}] = \int_{-\infty}^{+\infty} e^{iux} dF_X(x) = \int_{-\infty}^{+\infty} f(x) \cdot e^{iux} dx
$$

## 3.1. 특성함수의 유도

이는 곧 $E[g(X)]$의 $g(X)$ 대신 

$$
g(X) = e^{iuX}
$$

를 대입한 형태입니다.

$g(X)$의 형태는 $e^{iuX}$가 힐베르트 공간(Hilbert Space, L^2)의 직교 기저(orthogonal basis)이기 때문에 이렇게 선택되었습니다.

이 경우 힐베르트 공간의 모든 $f(x)$는 기저 벡터의 선형결합으로 표현될 수 있습니다. (힐베르트 공간에서의 함수는 그냥 벡터와 비슷하며 사실 이들은 벡터이나 힐베르트 공간은 무한 차원이며, 어떤 함수의 길이가 유한해서 $\int | f(x) |^2 < \infty$일때 힐베르트 공간에 속한다고 하는데 공부를 좀 더 해봐야 할 것 같습니다..)

이 기저의 직교성은 내적을 통해 쉽게 확인할 수 있습니다. 함수 공간에서 내적은 적분으로 정의되기 때문에 아래 수식이 성립합니다.

$$
\langle f,g \rangle = \int f(x) \overline{g(x)} dx
$$

이를 $g(X)$에 적용합니다.

$$
\int_{-\pi}^{\pi} e^{iux} \cdot \overline{e^{iwx}} dx = \int_{-\pi}^{\pi} e^{iux} \cdot e^{-iwx} dx = \int_{-\pi}^{\pi} e^{i(u-w)x} dx = \left.\frac{e^{i(u-w)x}}{i(u-w)}\right|_{-\pi}^\pi = 0 \quad (u \neq w)
$$

$u=w$일 경우 자기자신과의 내적이기 때문에 0이 아닌 상수의 값을 가지며, 따라서 주파수가 다른 $e^{iuX}$끼리는 서로 완벽하게 수직이며 직교기저에 해당함을 알 수 있습니다.

이때, 직교기저로 $e^{iuX}$를 선택하게 되면 미분을 곱셈으로 바꿀 수 있다는 장점이 있습니다. 즉, 아래 수식이 성립함으로 미분 연산자의 고유함수와 같이 기능한다는 사실을 활용할 수 있습니다.

$$
{d \over dx} e^{iux} = iu e^{iux}
$$

이때 $e^{iuX}$는 오일러 공식(Euler's formula)에 따라 다음과 같습니다.

$$
e^{iuX} = \cos(uX) + i \sin(uX)
$$

이를 통해 실수 공간의 푸리에 급수의 기저를 하나의 함수로 관리할 수 있습니다.

또한 확률변수의 덧셈에 관한 문제와도 관련이 있습니다. 우리가 주로 다루게 되는 확률변수(주가수익률, 이자율, ...)은 여러날 값의 합으로 주어집니다.

이렇게 확률변수를 더했을 때의 분포를 구하려면, Convolution(합성곱) 연산을 수행해야 합니다. Convolution 연산은 아래와 같이 복잡하게 주어집니다.

$$
f_{X+Y}(z) = \int f_X(x)f_Y(z-x) dx
$$

하지만 특성함수를 적용하게 되면 지수법칙에 따라 이를 단순한 곱셈으로 적용할 수 있습니다. (단, $X$와 $Y$가 독립일 때)

$$
\mathbb{E}[e^{iu(X+Y)}] = \mathbb{E}[e^{iuX}] \cdot \mathbb{E}[e^{iuY}]
$$

## 3.2. 푸리에 변환과 특성함수

> 특성함수(ChF) $\phi_X(u)$는 CDF $F_X(x)$의 푸리에-스틸체스 변환(Fourier-Stieltjes Transform; FST)이다.

이번엔 이 문장에 대해 생각해봅시다.

이때 Fourier-Stieltjes Transform은 측도에 대한 적분으로, 이러한 정의는 어떤 확률변수든 일반적으로 적용할 수 있도록(PDF가 없는 경우에도) 하는 ChF의 일반화된 형태입니다.

이때, 우리가 주로 관심있게 다루는 확률변수(주가수익률, 이자율, ...)의 경우 PDF가 존재합니다. 다만 전술한 바와 같이 우리의 문제는 그 정확한 함수의 형태를 알 수 없다는 것이기 때문에, 함수에 대한 적분 형태로 변환해 아래 문장이 성립하는 것으로 대체해볼 수 있겠습니다.

> 특성함수(ChF) $\phi_X(u)$는 PDF $f_X(x)$의 푸리에 변환(Fourier Transform; FT)이다.

직교기저인 $\sin$과 $\cos$을 통해서 주기함수를 급수형태로 나타냈다면, T를 무한정 크게 늘려서 주기를 가지지 않는 함수에 대해서도 이를 분해할 수 있을 것이라는 생각입니다.

이러한 푸리에 변환을 어떤 분포의 CDF에 적용한다는 것은 그 확률분포의 특징적인 데이터들을 분해해서 살펴보자는 것과 같다는 것이죠.

즉, 특성함수는 PDF의 푸리에 변환으로 이를 통해 우리는 주기를 가지지 않는 확률밀도함수를 다양한 주파수를 가진 파동들의 합으로 분해할 수 있고, 이렇게 분해된 데이터를 이용해 그 분포의 성질을 쉽게 계산할 수 있습니다.

다시 쉽게 이야기 해, 푸리에 변환의 관점(기저에서), 우리가 관심 있게 보는 어떠한 확률 변수의 분포는 사실 수많은 파동들이 합쳐진 결과물인 것이라고 생각해볼 수 있습니다.

그렇다는 이야기는 어떤 파동은 굵직한 평균을 만들고, 어떤 파동은 첨도를 정하고, 어떤 파동은 분산을 정하고, 어떤 파동은 Fat tail을 만든다는 이야기로 '해석' 될 수 있다는 것입니다.

즉, 우리는 특성함수를 미분하여 모멘트로 정의된 개별 파동들에 관한 값을 뽑아올 수 있고 이를 목적으로 특성함수를 사용하게 됩니다.

$$
\mathbb{E}\left[X^k\right] = \frac{1}{i^k} \frac{d^k}{du^k} \phi_X(u) \bigg|_{u=0}
$$

# 4. Moment Generating Function

Moment Generating function $M_X(u)$ 과 ChF 사이에는 다음과 같은 관계식이 존재합니다.
$$
\begin{align}

\mathbb{E}\left[X^k\right] &= \frac{1}{i^k} \frac{d^k}{du^k} \phi_X(u) \bigg|_{u=0} \stackrel{\text{def}}{=} \frac{1}{i^k} \frac{d^k}{du^k} \int_{-\infty}^{+\infty} e^{iux} dF_X(x) \bigg|_{u=0} = \frac{d^k}{du^k} \phi_X(-iu) \bigg|_{u=0} \\

\mathcal{M}_X(u) &:= \phi_X(-iu) = \mathbb{E}\left[e^{uX}\right]

\end{align}
$$

따라서 우리는 MGF $\mathcal{M}_X(u)$에 대해서 특성함수를 통해 정의내릴 수 있습니다.

# 5. Cumulants and moments (Cornelis 2019, Chapter 1.1.3)

아래 성질들은 특성함수의 정의로부터 도출됩니다.

$$

\phi_X(0) = \mathbb{E}[e^{i \times 0 \times X}] = e^0 = 1

$$

$$

\phi_X(-i) = \mathbb{E}[e^{i \times -i \times X}]=\mathbb{E}[e^X]

$$

또한 MGF의 정의로부터, 다음 식도 이해할 수 있습니다.

$$
\mathcal{M}_X(u) = \phi_X(-iu) = \int_\R e^{ux}f_X(x)dx
$$

그럼 $e^x$의 매클로린 급수(MacLaurin series)에 따라 다음식이 성립합니다.

$$
\mathcal{M}_X(u) = \phi_X(-iu) = \int_\R e^{ux}f_X(x)dx 
$$

$$
\sum_{k=0}^{\infty} {u^k \over k!} \int_\R x^k f_X(x)dx =: \sum_{k=0}^{\infty} \text{moment}_k {u^k \over k!}
$$

이때 정의에 따라 $\text{moment}_k = \int_\R x^k f_X(x)dx$이며 $k=0,1, ...$ 입니다.

한편, Cumulant-generating function은 다음과 같이 정의됩니다.

$$
\zeta_X(u) := \log \mathcal{M}_X(u)
$$

다시 여기에도 매클로린 전개를 적용하게 되면 아래와 같습니다.

$$
\zeta_X(u) = \left.\sum_{k=0}^\infty \frac{\partial^k \zeta_X(u)}{\partial u^k}\right|_{u=0} {u^k \over k!} =: \sum_{k=0}^\infty \zeta_k {u^k \over k!}
$$

이때 정의에 따라 $\zeta_k := \left.\frac{\partial^k \zeta_X(u)}{\partial u^k}\right|_{u=0}$는 $k$-th Cumulant 입니다.

결국 정의에 따라, MGF와 CGF는 아래 관계식이 성립합니다.

$$
\mathcal{M}_X(u) = \sum_{k=0}^\infty m_k {u^k \over k!} = \exp \left(\sum_{k=0}^\infty \zeta_k {u^k \over k!} \right)
$$

## 5.1. Derivatives and Derive Cumulants

그럼 이제 위의 관계식을 통해 아래와 같이 미분을 취해줄 수 있습니다.

$$
\zeta_X(u)=\log \mathcal{M}_X(u) = \log \phi_X(-iu)
$$

1계 미분:

$$
\frac{d \zeta_X(t)}{dt} = {1 \over \phi_X(-it)} \frac{d \phi(-it)}{dt}
$$

나머지 고계미분도 같은 방식으로 취해줄 수 있습니다.

미분을 취해준 뒤 $t=0$를 대입하게 되면 $\phi_X(0) = 1$의 성질과 $\phi_X(-i) = \mathbb{E}[e^X]$ 성질을 사용할 수 있습니다. 

예를들어:

$$
\frac{d \zeta_X(t)}{dt} = \left.{1 \over \phi_X(-it)} \frac{d \phi(-it)}{dt}\right|_{t=0} = \mathbb{E}[X]
$$
$$
\phi(-it) = \mathbb{E}[e^{tX}],{d\phi(-it) \over dt} = \mathbb{E}[X\cdot e^{tX}]
$$

같은 방식으로 2차, 3차, 4차 Cumulant까지 계산할 수 있게 되며 결론적으로 아래 관계식이 성립함을 쉽게 보일 수 있습니다.(미분 & $t=0$ 반복)

$$
\begin{align*}
\zeta_1 &= m_1 = \mu, \\
\zeta_2 &= m_2 - m_1^2 = \sigma^2, \\
\zeta_3 &= 2m_1^3 - 3m_1 m_2 + m_3 = \gamma_3 \sigma^3, \\
\zeta_4 &= -6m_1^4 + 12m_1^2 m_2 - 3m_2^2 - 4m_1 m_3 + m_4 = \gamma_4 \sigma^4
\end{align*}
$$

즉 ChF를 알면, 이를 통해 통계량을 구할 수 있습니다.

# 6. 다시 PDF로: Inverse Fourier Transform

PDF와 ChF의 관계를 통해 PDF를 복원(recover) 할 수 있습니다.

푸리에 변환은 가역적이기 때문에, 아래 관계식이 성립합니다.

$$
f_X(x) = {1 \over 2\pi} \int_\R \phi_X(u) e^{-iux} du
$$

그럼 다시 특성함수와 0 근처에서 전개된 매클로린 급수에 따라 위 식을 아래와 같이 변형할 수 있습니다.

$$
\phi_X(u) = \mathbb{E}[e^{iuX}] = \sum_{k=0}^\infty {(iu)^k \over k!} \mathbb{E}[X^k] = \sum_{k=0}^\infty {(iu)^k \over k!} m_k,
$$

$$
f_X(x) = {1 \over 2\pi} \sum_{k=0}^\infty {m_k \over k!} \int_\R (iu)^k e^{-iux} du
$$

이때, $m_k$는 위에서 정의한 $\text{moment}_k$ 입니다.

이때, 디랙 델타 함수를 도입합니다.

디랙 델타 함수는 아래와 같이 정의됩니다.

디랙 델타 함수의 정의:

$$
\delta(x) = 
\begin{cases}
+ \infty, & x=0, \\
0 , & x \neq 0
\end{cases}
$$

따라서 다음과 같이 나타낼 수 있습니다.

$$
\delta(x) = {1 \over 2\pi} \int_\R e^{-iux} du
$$

디렉 델타 함수의 $k$-th 미분:

$$
\delta^{(k)}(x) = {d^k \over dx^k} \delta(x) = {1 \over 2\pi} \int_\R (-iu)^k e^{-iux} du
$$

이러한 결과에 따라서 본래 PDF는 다음과 같이 정리될 수 있습니다.

$$
f_X(x) = \sum_{k=0}^\infty (-1)^k {m_k \over k!} \delta^{(k)} (x)
$$

## 6.1. Intuition

이렇든 특성함수의 도입은 파생상품 가격결정 방식에 또다른 해답을 제시하게 됩니다. 1973년 Black-Scholes Model 시기에는 PDE를 풀어서 PDF를 구하고, 옵션가격을 결정하는 것이 가능했었습니다. 모델링해야하는 Dynamics도 하나였고 상품의 구조도 그리 복잡하지 않았기 때문입니다.

그러나 점차 시장이 발달하며 BSM의 가정들이 부정되었고, 거래되는 상품의 복잡도도 함께 증대되며 기존과는 다른 접근방식이 필요해지게 됩니다. 이때 도입된 방법론에 특성함수가 활용됩니다.

PDF를 직접 구하는 것이 아니라, 모델을 Affine 계열로 설정하여 특성함수를 Closed Form으로 구한 뒤, 이를 Inverse Fourier Transform 하여 PDF를 우회적으로 구해 파생상품의 가격을 구하고자 하는 시도였습니다.

이러한 시도의 대표적인 모델이 Heston Model이며, Carr-Madan 공식의 방법론도 참고해볼 수 있다고 합니다.

# Reference

- Law of the unconscious statistician (https://en.wikipedia.org/wiki/Law_of_the_unconscious_statistician)
- Euler's formula (https://en.wikipedia.org/wiki/Euler%27s_formula)

- Gilbert Strang, Differential Equations and Linear Algebra
- Cornelis W Oosterlee, Lech A Grzelak. Mathematical Modeling and Computation in Finance, 2019

- 푸리에 급수(https://angeloyeo.github.io/2019/06/23/Fourier_Series.html)
- 푸리에 변환(https://angeloyeo.github.io/2019/07/07/CTFT.html)